<!DOCTYPE html>
<html lang="en">
<%- include("../partials/head.ejs", {title: "Manage Categories"}) %>

<body class="bg-gray-100 min-h-screen flex">

  <!-- Sidebar -->
  <aside class="w-64 bg-gray-900 text-gray-100 flex flex-col">

    <div class="px-6 py-5 text-2xl font-bold border-b border-gray-800">
      Admin Panel
    </div>

    <nav class="flex-1 px-4 py-6 space-y-2">
      <a href="/admin/dashboard" class="block px-4 py-2 rounded hover:bg-gray-800">
        Dashboard
      </a>
      <a href="/admin/categories" class="block px-4 py-2 rounded bg-gray-800">
        Manage Categories
      </a>
      <a href="/admin/blogs" class="block px-4 py-2 rounded hover:bg-gray-800">
        Manage Blogs
      </a>
      <a href="/admin/users" class="block px-4 py-2 rounded hover:bg-gray-800">
        Manage Users
      </a>
      <a href="/admin/comments" class="block px-4 py-2 rounded hover:bg-gray-800">
        Manage Comments
      </a>
    </nav>

    <div class="px-4 py-4 border-t border-gray-800 text-sm text-gray-400">
      Logged in as <span class="text-white font-medium"><%= admin?.username %></span>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8">

    <!-- Toast Flash -->
    <%- include('../partials/toast') %>

    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
      <h1 class="text-3xl font-bold text-gray-800">Category Management</h1>
    </div>

    <!-- Create Category -->
    <div class="bg-white rounded-xl shadow p-6 mb-8">
      <h2 class="text-lg font-semibold text-gray-800 mb-4">
        Create New Category
      </h2>

      <form action="/admin/categories/add" method="POST" class="flex flex-col sm:flex-row gap-4">
        <input
          type="text"
          name="name"
          placeholder="Enter category name"
          required
          class="flex-1 px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"
        />

        <button
          type="submit"
          class="px-6 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white font-semibold"
        >
          Add Category
        </button>
      </form>
    </div>

    <!-- Categories Table -->
    <div class="bg-white rounded-xl shadow p-6">

      <h2 class="text-lg font-semibold text-gray-800 mb-4">
        All Categories
      </h2>

      <% if (categories && categories.length === 0) { %>
        <p class="text-gray-500 text-sm">No categories found.</p>
      <% } else { %>

      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="text-left px-4 py-2 border">Name</th>
              <th class="text-left px-4 py-2 border">Slug</th>
              <th class="text-left px-4 py-2 border">Created At</th>
              <th class="text-center px-4 py-2 border">Actions</th>
            </tr>
          </thead>
          <tbody>

            <% categories.forEach(category => { %>
              <tr class="hover:bg-gray-50">
                <td class="px-4 py-2 border font-medium">
                  <%= category?.name %>
                </td>

                <td class="px-4 py-2 border font-medium">
                  <%= category?.slug %>
                </td>

                <td class="px-4 py-2 border text-sm text-gray-600">
                  <%= new Date(category?.createdAt).toLocaleDateString() %>
                </td>

                <td class="px-4 py-2 border text-center">
                  <form
                    action="/admin/categories/<%= category._id %>?_method=DELETE"
                    method="POST"
                    onsubmit="return confirm('Are you sure you want to delete this category?')"
                    class="inline"
                  >
                    <button
                      type="submit"
                      class="px-3 py-1 rounded bg-red-600 hover:bg-red-700 text-white text-sm font-semibold"
                    >
                      Delete
                    </button>
                  </form>
                </td>
              </tr>
            <% }) %>

          </tbody>
        </table>
      </div>

      <% } %>
    </div>

  </main>

</body>
</html>
